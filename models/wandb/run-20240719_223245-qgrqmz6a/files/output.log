===================================================================== EVALUATING / SAVING -- iteration 0 =====================================================================
TRAIN | Total Loss: 16.9740 | Task Loss: 10.9774 | Spatial Loss: 5.9967
VALID | Total Loss: 16.9623 | Task Loss: 10.9671 | Spatial Loss: 5.9951
Traceback (most recent call last):
  File "/Users/rathi/projects/topo-eval/models/train.py", line 325, in <module>
    logits, loss, task_loss, spatial_loss, spatial_outputs = model(X, Y)
                                                             ^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rathi/projects/topo-eval/models/model.py", line 201, in forward
    spatial_loss += self.alphas[i] * spatial_loss_fn(*spatial_outputs[name])
                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rathi/projects/topo-eval/models/positions.py", line 138, in spatial_loss_fn
    cur_loss.append(local_spatial_loss(activations[:, mask], positions.coordinates[mask]))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/rathi/projects/topo-eval/models/positions.py", line 128, in local_spatial_loss
    return 0.5 * (1 - torch.corrcoef(torch.stack([r[idx], D[idx]], dim = 0))[0, 1])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt